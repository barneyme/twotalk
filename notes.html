<!doctype html>
<html>
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Two Talk Notes</title>
        <link
            rel="icon"
            href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='80' font-size='70' fill='%23cc5500' font-family='Courier New, monospace' font-weight='bold'>TT</text></svg>"
        />
        <style>
            * {
                box-sizing: border-box;
            }
            body {
                font-family: "Courier New", monospace;
                background: #fdfdfd;
                color: #222;
                padding: 15px;
                max-width: 900px;
                margin: auto;
                line-height: 1.6;
            }
            h1 {
                font-weight: bold;
                color: darkorange;
                margin-bottom: 0.2em;
                letter-spacing: 1px;
            }
            .subtitle {
                color: #666;
                font-size: 14px;
                margin-bottom: 1.5em;
            }
            label {
                display: block;
                font-weight: bold;
                color: darkorange;
                margin-bottom: 0.5em;
            }

            .palette {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(45px, 1fr));
                gap: 8px;
                margin-bottom: 20px;
                background: #f0f0f0;
                padding: 12px;
                border-radius: 8px;
                border: 1px solid #ddd;
            }
            .symbol-btn {
                height: 45px;
                font-family: inherit;
                font-size: 20px;
                font-weight: bold;
                background: white;
                border: 1px solid #ccc;
                border-radius: 6px;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
                transition: 0.1s;
                color: #333;
                touch-action: manipulation;
            }
            .symbol-btn:active {
                background: darkorange;
                color: white;
                transform: scale(0.95);
            }
            .symbol-btn.category {
                border-bottom: 3px solid darkorange;
            }

            textarea {
                width: 100%;
                padding: 15px;
                font-family: "Courier New", monospace;
                font-size: 18px;
                border: 2px solid #ddd;
                border-radius: 4px;
                min-height: 120px;
                margin-bottom: 20px;
            }

            .sentence-container {
                background: #fff3e6;
                padding: 20px;
                border: 2px solid darkorange;
                border-radius: 8px;
                margin-bottom: 20px;
                font-size: 20px;
                font-weight: bold;
                color: #333;
                min-height: 60px;
            }

            .translation-container {
                background: #f9f9f9;
                padding: 15px;
                border: 1px solid #e0e0e0;
                border-left: 5px solid darkorange;
                border-radius: 4px;
                min-height: 100px;
                margin-bottom: 20px;
            }
            .pair-row {
                margin-bottom: 15px;
                padding-bottom: 10px;
                border-bottom: 1px dashed #ddd;
            }
            .pair-label {
                font-weight: bold;
                color: darkorange;
                font-size: 1.2em;
            }
            .chip-container {
                display: flex;
                flex-wrap: wrap;
                gap: 8px;
                margin-top: 8px;
            }

            .meaning-chip {
                background: white;
                border: 1px solid #bbb;
                padding: 6px 14px;
                border-radius: 20px;
                font-size: 14px;
                cursor: pointer;
            }
            .meaning-chip.selected {
                background: darkorange;
                color: white;
                border-color: darkorange;
            }
            .placeholder-text {
                color: #888;
                font-style: italic;
                font-weight: normal;
                font-size: 16px;
            }

            .suggestion-box {
                background: #eef6ff;
                border: 1px solid #b6d4fe;
                border-radius: 4px;
                padding: 12px;
                margin-bottom: 20px;
            }
            .suggest-chip {
                display: inline-block;
                background: #fff;
                border: 1px solid #0d6efd;
                color: #0d6efd;
                padding: 4px 10px;
                border-radius: 4px;
                margin: 4px;
                cursor: pointer;
                font-weight: bold;
                font-size: 14px;
            }
            .suggest-chip:hover {
                background: #0d6efd;
                color: white;
            }

            .action-btn {
                padding: 12px 20px;
                color: white;
                background: darkorange;
                border: none;
                border-radius: 8px;
                cursor: pointer;
                font-weight: bold;
                font-family: inherit;
                font-size: 16px;
                width: 100%;
                margin-top: 10px;
                transition: 0.2s;
            }
            .action-btn:hover {
                background: #d35400;
            }
        </style>
    </head>
    <body>
        <h1>Two Talk Notes</h1>
        <div class="subtitle">
            Translate Two Talk to English & English to Two Talk
        </div>

        <div class="palette" id="palette"></div>

        <label for="noteInput">Input (Two Talk or English)</label>
        <textarea
            id="noteInput"
            placeholder="Try typing 'person' or 'plan'..."
        ></textarea>

        <div id="englishToTalk" class="suggestion-box" style="display: none">
            <label style="color: #0d6efd; font-size: 14px"
                >Two Talk suggestions (click to add):</label
            >
            <div id="suggestionList"></div>
        </div>

        <label>Translated Sentence</label>
        <div id="sentenceBox" class="sentence-container">
            <span class="placeholder-text"
                >Your sentence will appear here...</span
            >
        </div>

        <label>Refine Meanings</label>
        <div id="translationBox" class="translation-container">
            <span class="placeholder-text">Waiting for symbols...</span>
        </div>

        <button class="action-btn" onclick="saveNote()">
            Save Note (.txt)
        </button>

        <script>
            const symbols = [
                "@",
                "#",
                "/",
                ":",
                "^",
                '"',
                "%",
                "*",
                "!",
                "?",
                ">",
                "<",
                "=",
                "+",
                "-",
                "\\",
            ];

            const dictionary = {
                // ! (Priority)
                "!!": "emergency; urgent; trigger",
                "!@": "vip; role; assign",
                "!#": "requirement; structure; build",
                "!/": "critical path; method; execute",
                "!:": "deadline; schedule; plan",
                "!^": "hotspot; context; locate",
                '!"': "alarm; information; communicate",
                "!%": "key value; value; allocate",
                "!*": "highlight; quality; adjust",
                "!?": "warning; ambiguity; explore",
                "!>": "goal; progress; advance",
                "!<": "bottleneck; constraint; reduce",
                "!=": "mandate; consistency; maintain",
                "!+": "bonus; addition; increase",
                "!-": "risk; subtraction; remove",
                "!\\": "safety net; support; underlay",

                // @ (Person)
                "@!": "stakeholder; urgent; trigger",
                "@@": "person; role; assign",
                "@#": "member; structure; build",
                "@/": "worker; method; execute",
                "@:": "attendee; schedule; plan",
                "@^": "visitor; context; locate",
                '@"': "speaker; information; communicate",
                "@%": "owner; value; allocate",
                "@*": "reviewer; quality; adjust",
                "@?": "contact; ambiguity; explore",
                "@>": "leader; progress; advance",
                "@<": "follower; constraint; reduce",
                "@=": "peer; consistency; maintain",
                "@+": "recruit; addition; join",
                "@-": "departure; subtraction; remove",
                "@\\": "assistant; support; underlay",

                // # (Item)
                "#!": "essential; urgent; trigger",
                "#@": "user; role; assign",
                "##": "tool; structure; build",
                "#/": "document; method; execute",
                "#:": "task; schedule; plan",
                "#^": "module; context; locate",
                '#"': "package; information; communicate",
                "#%": "file; value; allocate",
                "#*": "draft; quality; adjust",
                "#?": "asset; ambiguity; explore",
                "#>": "output; progress; advance",
                "#<": "input; constraint; reduce",
                "#=": "template; consistency; maintain",
                "#+": "add-on; addition; increase",
                "#-": "component; subtraction; remove",
                "#\\": "infrastructure; support; underlay",

                // / (Method)
                "/!": "flashpoint; urgent; trigger",
                "/@": "process; role; assign",
                "/#": "workflow; structure; build",
                "//": "operation; method; execute",
                "/:": "routine; schedule; plan",
                "/^": "cycle; context; locate",
                '/"': "sequence; information; communicate",
                "/%": "procedure; value; allocate",
                "/*": "method; quality; adjust",
                "/?": "iteration; ambiguity; explore",
                "/>": "review; progress; advance",
                "/<": "sprint; constraint; reduce",
                "/=": "maintenance; consistency; maintain",
                "/+": "pipeline; addition; increase",
                "/-": "shortcut; subtraction; simplify",
                "/\\": "backup; support; revert",

                // : (Time)
                ":!": "instancy; urgent; trigger",
                ":@": "shift; role; assign",
                ":#": "slot; structure; build",
                ":/": "phase; method; execute",
                "::": "period; schedule; plan",
                ":^": "window; context; locate",
                ':"': "interval; information; communicate",
                ":%": "moment; value; allocate",
                ":*": "date; quality; adjust",
                ":?": "cycle; ambiguity; explore",
                ":>": "horizon; progress; advance",
                ":<": "delay; constraint; reduce",
                ":=": "cadence; consistency; maintain",
                ":+": "extension; addition; increase",
                ":-": "cutoff; subtraction; remove",
                ":\\": "history; support; revert",

                // ^ (Place)
                "^!": "stage; urgent; trigger",
                "^@": "host; role; assign",
                "^#": "room; structure; build",
                "^/": "site; method; execute",
                "^:": "area; schedule; plan",
                "^^": "zone; context; locate",
                '^"': "region; information; communicate",
                "^%": "venue; value; allocate",
                "^*": "station; quality; adjust",
                "^?": "origin; ambiguity; explore",
                "^>": "destination; progress; advance",
                "^<": "boundary; constraint; reduce",
                "^=": "anchor; consistency; maintain",
                "^+": "annex; addition; increase",
                "^-": "void; subtraction; remove",
                "^\\": "basement; support; underlay",

                // " (Message)
                '"!': "alert; urgent; trigger",
                '"@': "profile; role; assign",
                '"#': "report; structure; build",
                '"/': "stream; method; execute",
                '":': "log; schedule; plan",
                '"^': "metadata; context; locate",
                '""': "message; information; communicate",
                '"%': "data; value; allocate",
                '"*': "feedback; quality; adjust",
                '"?': "query; ambiguity; explore",
                '">': "brief; progress; advance",
                '"<': "note; constraint; reduce",
                '"=': "standard; consistency; maintain",
                '"+': "appendix; addition; increase",
                '"-': "summary; subtraction; remove",
                '"\\': "footnote; support; underlay",

                // % (Resource)
                "%!": "debt; urgent; trigger",
                "%@": "personnel; role; assign",
                "%#": "supply; structure; build",
                "%/": "expense; method; execute",
                "%:": "budget; schedule; plan",
                "%^": "wallet; context; locate",
                '%"': "metric; information; communicate",
                "%%": "value; value; allocate",
                "%*": "level; quality; adjust",
                "%?": "estimate; ambiguity; explore",
                "%>": "profit; progress; advance",
                "%<": "loss; constraint; reduce",
                "%=": "balance; consistency; maintain",
                "%+": "revenue; addition; increase",
                "%-": "cost; subtraction; remove",
                "%\\": "reserve; support; underlay",

                // * (State)
                "*!": "alarm; urgent; trigger",
                "*@": "expert; role; assign",
                "*#": "build; structure; build",
                "*/": "performance; method; execute",
                "*:": "maturity; schedule; plan",
                "*^": "environment; context; locate",
                '*"': "status; information; communicate",
                "*%": "health; value; allocate",
                "**": "state; quality; adjust",
                "*?": "risk; ambiguity; explore",
                "*>": "growth; progress; advance",
                "*<": "decline; constraint; reduce",
                "*=": "stability; consistency; maintain",
                "*+": "improving; addition; increase",
                "*-": "wear; subtraction; remove",
                "*\\": "foundation; support; underlay",

                // ? (Unknown)
                "?!": "crisis; urgent; trigger",
                "?@": "stranger; role; assign",
                "?#": "mystery; structure; build",
                "?/": "experiment; method; execute",
                "?:": "guess; schedule; plan",
                "?^": "hidden; context; locate",
                '?"': "rumor; information; communicate",
                "?%": "gamble; value; allocate",
                "?*": "threat; quality; adjust",
                "??": "question; ambiguity; explore",
                "?>": "hypothesis; progress; advance",
                "?<": "anomaly; constraint; reduce",
                "?=": "pending; consistency; maintain",
                "?+": "curiosity; addition; increase",
                "?-": "absence; subtraction; remove",
                "?\\": "theory; support; underlay",

                // > (Outcome)
                ">!": "target; urgent; trigger",
                ">@": "successor; role; assign",
                ">#": "product; structure; build",
                ">/": "delivery; method; execute",
                ">:": "milestone; schedule; plan",
                ">^": "goal; context; locate",
                '>"': "report; information; communicate",
                ">%": "return; value; allocate",
                ">*": "impact; quality; adjust",
                ">?": "upside; ambiguity; explore",
                ">>": "outcome; progress; advance",
                "><": "result; constraint; reduce",
                ">=": "yield; consistency; maintain",
                ">+": "surplus; addition; increase",
                ">-": "exit; subtraction; remove",
                ">\\": "legacy; support; underlay",

                // < (Issue)
                "<!": "incident; urgent; trigger",
                "<@": "culprit; role; assign",
                "<#": "bug; structure; build",
                "</": "error; method; execute",
                "<:": "delay; schedule; plan",
                "<^": "barrier; context; locate",
                '<"': "complaint; information; communicate",
                "<%": "shortfall; value; allocate",
                "<*": "defect; quality; adjust",
                "<?": "doubt; ambiguity; explore",
                "<>": "conflict; progress; advance",
                "<<": "issue; constraint; reduce",
                "<=": "drag; consistency; maintain",
                "<+": "inflation; addition; increase",
                "<-": "reduction; subtraction; remove",
                "<\\": "debt; support; underlay",

                // = (Baseline)
                "=!": "rule; urgent; trigger",
                "=@": "peer; role; assign",
                "=#": "pattern; structure; build",
                "=/": "habit; method; execute",
                "=:": "cadence; schedule; plan",
                "=^": "base; context; locate",
                '="': "fact; information; communicate",
                "=%": "parity; value; allocate",
                "=*": "norm; quality; adjust",
                "=?": "neutral; ambiguity; explore",
                "=>": "standard; progress; advance",
                "=<": "limit; constraint; reduce",
                "==": "baseline; consistency; maintain",
                "=+": "stock; addition; increase",
                "=-": "average; subtraction; remove",
                "=\\": "basis; support; underlay",

                // + (Addition)
                "+!": "urgent; urgent; trigger",
                "+@": "hire; role; assign",
                "+#": "asset; structure; build",
                "+/": "intake; method; execute",
                "+:": "extension; schedule; plan",
                "+^": "expansion; context; locate",
                '+"': "update; information; communicate",
                "+%": "profit; value; allocate",
                "+*": "upgrade; quality; adjust",
                "+?": "opportunity; ambiguity; explore",
                "+>": "growth; progress; advance",
                "+<": "buffer; constraint; reduce",
                "+=": "accrual; consistency; maintain",
                "++": "addition; addition; increase",
                "+-": "swap; subtraction; adjust",
                "+\\": "reinforcement; support; underlay",

                // - (Subtraction)
                "-!": "cut; urgent; trigger",
                "-@": "exit; role; assign",
                "-#": "deletion; structure; build",
                "-/": "shortcut; method; execute",
                "-:": "deadline; schedule; plan",
                "-^": "narrowing; context; locate",
                '-"': "summary; information; communicate",
                "-%": "expense; value; allocate",
                "-*": "decay; quality; adjust",
                "-?": "loss; ambiguity; explore",
                "->": "result; progress; advance",
                "-<": "minimum; constraint; reduce",
                "-=": "average; consistency; maintain",
                "-+": "offset; addition; increase",
                "--": "subtraction; subtraction; remove",
                "-\\": "stripping; support; underlay",

                // \ (Support)
                "\\!": "fix; urgent; trigger",
                "\\@": "mentor; role; assign",
                "\\#": "chassis; structure; build",
                "\\/": "automation; method; execute",
                "\\:": "archive; schedule; plan",
                "\\^": "foundation; context; locate",
                '\\"': "reference; information; communicate",
                "\\%": "subsidy; value; allocate",
                "\\*": "standard; quality; adjust",
                "\\?": "theory; ambiguity; explore",
                "\\>": "legacy; progress; advance",
                "\\<": "guardrail; constraint; reduce",
                "\\=": "basic; consistency; maintain",
                "\\+": "underpinning; addition; increase",
                "\\-": "erosion; subtraction; remove",
                "\\\\": "support; support; underlay",
            };

            const selections = {};
            const palette = document.getElementById("palette");
            const input = document.getElementById("noteInput");

            // Setup palette with 16 symbols
            symbols.forEach((s) => {
                const btn = document.createElement("button");
                btn.className = "symbol-btn category";
                btn.textContent = s;
                btn.onclick = () => insertAtCursor(s);
                palette.appendChild(btn);
            });

            function insertAtCursor(text) {
                const start = input.selectionStart;
                input.value =
                    input.value.substring(0, start) +
                    text +
                    input.value.substring(input.selectionEnd);
                input.selectionStart = input.selectionEnd = start + text.length;
                input.focus();
                runTranslation();
            }

            function runTranslation() {
                const text = input.value;
                const container = document.getElementById("translationBox");
                const sentenceBox = document.getElementById("sentenceBox");
                const suggestBox = document.getElementById("englishToTalk");
                const suggestList = document.getElementById("suggestionList");

                // Regex updated for 16 symbols
                const regex = /[@#\/:^"%*!><=+\-\\]{2}/g;
                const matches = text.match(regex) || [];

                if (matches.length === 0) {
                    container.innerHTML =
                        '<span class="placeholder-text">Waiting for symbols...</span>';
                    sentenceBox.innerHTML =
                        '<span class="placeholder-text">Your sentence will appear here...</span>';
                } else {
                    container.innerHTML = "";
                    let sentenceParts = [];
                    matches.forEach((pair, index) => {
                        if (!dictionary[pair]) return;
                        const selectionId = `${index}_${pair}`;
                        const row = document.createElement("div");
                        row.className = "pair-row";
                        row.innerHTML = `<div class="pair-label">${pair}</div>`;
                        const chipContainer = document.createElement("div");
                        chipContainer.className = "chip-container";
                        const meanings = dictionary[pair]
                            .split(";")
                            .map((m) => m.trim());
                        meanings.forEach((m) => {
                            const chip = document.createElement("div");
                            chip.className =
                                "meaning-chip" +
                                (selections[selectionId] === m
                                    ? " selected"
                                    : "");
                            chip.textContent = m;
                            chip.onclick = () => {
                                selections[selectionId] =
                                    selections[selectionId] === m ? null : m;
                                runTranslation();
                            };
                            if (
                                !selections[selectionId] ||
                                selections[selectionId] === m
                            )
                                chipContainer.appendChild(chip);
                        });
                        sentenceParts.push(
                            selections[selectionId] || `[${pair}]`,
                        );
                        row.appendChild(chipContainer);
                        container.appendChild(row);
                    });
                    sentenceBox.textContent = sentenceParts.join(" ");
                }

                // English to Shorthand Suggestions
                suggestList.innerHTML = "";
                const words = text.toLowerCase().split(/\W+/);
                const matchesSuggestions = [];

                Object.entries(dictionary).forEach(([pair, meaningString]) => {
                    const meaningsArray = meaningString
                        .split(";")
                        .map((m) => m.trim().toLowerCase());
                    words.forEach((w) => {
                        if (w.length > 2 && meaningsArray.includes(w)) {
                            matchesSuggestions.push({ pair, word: w });
                        }
                    });
                });

                if (matchesSuggestions.length > 0) {
                    suggestBox.style.display = "block";
                    const uniqueSuggestions = matchesSuggestions.filter(
                        (v, i, a) =>
                            a.findIndex((t) => t.pair === v.pair) === i,
                    );
                    uniqueSuggestions.forEach((s) => {
                        const chip = document.createElement("span");
                        chip.className = "suggest-chip";
                        chip.textContent = `${s.pair} (${s.word})`;
                        chip.onclick = () => {
                            insertAtCursor(" " + s.pair + " ");
                        };
                        suggestList.appendChild(chip);
                    });
                } else {
                    suggestBox.style.display = "none";
                }
            }

            function saveNote() {
                const inputContent = document.getElementById("noteInput").value;
                const translationContent =
                    document.getElementById("sentenceBox").innerText;

                if (!inputContent.trim()) {
                    alert("Write something before saving!");
                    return;
                }

                const content = `TWO TALK NOTE\nCreated: ${new Date().toLocaleString()}\n\nINPUT:\n${inputContent}\n\nTRANSLATION:\n${translationContent}`;

                const blob = new Blob([content], { type: "text/plain" });
                const a = document.createElement("a");
                a.href = URL.createObjectURL(blob);
                a.download = `twotalk_note_${new Date().toISOString().split("T")[0]}.txt`;
                a.click();
            }

            input.addEventListener("input", runTranslation);
        </script>
    </body>
</html>
